{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///E:/pharmacy-system-v2/frontend/context/permissions.js"],"sourcesContent":["// جميع الصلاحيات الأساسية\r\nexport const ROLE_DEFAULT_PERMISSIONS = {\r\n  admin: [\r\n    \"view_dashboard\",\r\n    \"manage_products\",\r\n    \"view_inventory\",\r\n    \"update_inventory\",\r\n    \"view_sales\",\r\n    \"add_sale\",\r\n    \"return_sale\",\r\n    \"open_shift\",\r\n    \"close_shift\",\r\n    \"view_shift_report\",\r\n    \"manage_users\",\r\n    \"view_reports\",\r\n    \"view_accounts\",\r\n    \"view_activity_log\"\r\n  ],\r\n\r\n  pharmacist: [\r\n    \"manage_products\",\r\n    \"view_inventory\",\r\n    \"update_inventory\",\r\n    \"add_sale\",\r\n    \"view_sales\",\r\n    \"view_reports\",\r\n    \"view_activity_log\"\r\n  ],\r\n\r\n  cashier: [\r\n    \"add_sale\",\r\n    \"return_sale\",\r\n    \"open_shift\",\r\n    \"close_shift\",\r\n    \"view_sales\"\r\n  ]\r\n};\r\n\r\n// الصلاحيات المطلوبة لكل صفحة\r\nexport const ROUTE_PERMISSIONS = {\r\n  \"/dashboard\": [\"view_dashboard\"],\r\n\r\n  \"/products\": [\"manage_products\"],\r\n  \"/inventory\": [\"view_inventory\"],\r\n  \"/pharmacist\": [\"manage_products\"],\r\n\r\n  \"/sales\": [\"view_sales\"],\r\n  \"/cashier\": [\"add_sale\"],\r\n  \"/shift\": [\"open_shift\"],\r\n  \"/shift-report\": [\"view_shift_report\"],\r\n  \"/return\": [\"return_sale\"],\r\n\r\n  \"/accounts\": [\"view_accounts\"],\r\n\r\n  \"/reports\": [\"view_reports\"],\r\n  \"/activity-log\": [\"view_activity_log\"],\r\n\r\n  \"/users\": [\"manage_users\"]\r\n};\r\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;;AACnB,MAAM,2BAA2B;IACtC,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,YAAY;QACV;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,SAAS;QACP;QACA;QACA;QACA;QACA;KACD;AACH;AAGO,MAAM,oBAAoB;IAC/B,cAAc;QAAC;KAAiB;IAEhC,aAAa;QAAC;KAAkB;IAChC,cAAc;QAAC;KAAiB;IAChC,eAAe;QAAC;KAAkB;IAElC,UAAU;QAAC;KAAa;IACxB,YAAY;QAAC;KAAW;IACxB,UAAU;QAAC;KAAa;IACxB,iBAAiB;QAAC;KAAoB;IACtC,WAAW;QAAC;KAAc;IAE1B,aAAa;QAAC;KAAgB;IAE9B,YAAY;QAAC;KAAe;IAC5B,iBAAiB;QAAC;KAAoB;IAEtC,UAAU;QAAC;KAAe;AAC5B","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///E:/pharmacy-system-v2/frontend/context/AuthContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { ROUTE_PERMISSIONS, ROLE_DEFAULT_PERMISSIONS } from \"./permissions\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);           // بيانات المستخدم\r\n  const [loading, setLoading] = useState(true);     // تحميل الجلسة\r\n\r\n  // تحميل الجلسة من التخزين\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem(\"pharmacy_user\");\r\n    if (saved) {\r\n      setUser(JSON.parse(saved));\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  // تسجيل الدخول (نسخة تجريبية)\r\n  const login = (username, password) => {\r\n    const USERS = [\r\n      { username: \"admin\", password: \"123\", role: \"admin\", name: \"المدير\" },\r\n      { username: \"ph\", password: \"123\", role: \"pharmacist\", name: \"الصيدلي\" },\r\n      { username: \"ca\", password: \"123\", role: \"cashier\", name: \"الكاشير\" }\r\n    ];\r\n\r\n    const found = USERS.find(\r\n      (u) => u.username === username && u.password === password\r\n    );\r\n\r\n    if (!found) return null;\r\n\r\n    const permList = ROLE_DEFAULT_PERMISSIONS[found.role] || [];\r\n\r\n    const u = {\r\n      username: found.username,\r\n      role: found.role,\r\n      name: found.name,\r\n      permissions: permList\r\n    };\r\n\r\n    localStorage.setItem(\"pharmacy_user\", JSON.stringify(u));\r\n    setUser(u);\r\n    return u;\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"pharmacy_user\");\r\n    setUser(null);\r\n  };\r\n\r\n  // التحقق من الصلاحيات\r\n  const hasPermission = (perm) => {\r\n    if (!user) return false;\r\n    if (!user.permissions) return false;\r\n    return user.permissions.includes(perm);\r\n  };\r\n\r\n  // التحقق من الصلاحية الخاصة بالصفحة\r\n  const canAccessRoute = (path) => {\r\n    if (!user) return false;\r\n\r\n    const required = ROUTE_PERMISSIONS[path];\r\n    if (!required) return true; // صفحة عامة\r\n\r\n    return required.some((perm) => user.permissions.includes(perm));\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        login,\r\n        logout,\r\n        hasPermission,\r\n        canAccessRoute,\r\n        loading\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// // context/AuthContext.js\r\n// import { createContext, useContext, useState } from \"react\";\r\n\r\n// const AuthContext = createContext();\r\n\r\n// export function AuthProvider({ children }) {\r\n//   // مستخدم افتراضي (يمكن تعديله لاحقًا من شاشة الدخول)\r\n//   const [user, setUser] = useState({\r\n//     name: \"المدير أحمد\",\r\n//     role: \"admin\", // admin | cashier | pharmacist\r\n//   });\r\n\r\n//   // التحقق من الصلاحيات\r\n//   const hasPermission = (roles) => roles.includes(user.role);\r\n\r\n//   return (\r\n//     <AuthContext.Provider value={{ user, setUser, hasPermission }}>\r\n//       {children}\r\n//     </AuthContext.Provider>\r\n//   );\r\n// }\r\n\r\n// export function useAuth() {\r\n//   return useContext(AuthContext);\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import { createContext, useContext, useState } from \"react\";\r\n\r\n// const AuthContext = createContext();\r\n\r\n// export function AuthProvider({ children }) {\r\n//   const [user, setUser] = useState({\r\n//     name: \"المدير أحمد\",\r\n//     role: \"admin\", // admin | cashier | pharmacist\r\n//   });\r\n\r\n//   const hasPermission = (roles) => {\r\n//     return roles.includes(user.role);\r\n//   };\r\n\r\n//   return (\r\n//     <AuthContext.Provider value={{ user, setUser, hasPermission }}>\r\n//       {children}\r\n//     </AuthContext.Provider>\r\n//   );\r\n// }\r\n\r\n// export const useAuth = () => useContext(AuthContext);\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;AAEA,MAAM,4BAAc,IAAA,oHAAa;AAE1B,SAAS,aAAa,EAAE,QAAQ,EAAE;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAC,OAAiB,kBAAkB;IACpE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC,OAAW,eAAe;IAEjE,0BAA0B;IAC1B,IAAA,gHAAS,EAAC;QACR,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,OAAO;YACT,QAAQ,KAAK,KAAK,CAAC;QACrB;QACA,WAAW;IACb,GAAG,EAAE;IAEL,8BAA8B;IAC9B,MAAM,QAAQ,CAAC,UAAU;QACvB,MAAM,QAAQ;YACZ;gBAAE,UAAU;gBAAS,UAAU;gBAAO,MAAM;gBAAS,MAAM;YAAS;YACpE;gBAAE,UAAU;gBAAM,UAAU;gBAAO,MAAM;gBAAc,MAAM;YAAU;YACvE;gBAAE,UAAU;gBAAM,UAAU;gBAAO,MAAM;gBAAW,MAAM;YAAU;SACrE;QAED,MAAM,QAAQ,MAAM,IAAI,CACtB,CAAC,IAAM,EAAE,QAAQ,KAAK,YAAY,EAAE,QAAQ,KAAK;QAGnD,IAAI,CAAC,OAAO,OAAO;QAEnB,MAAM,WAAW,2IAAwB,CAAC,MAAM,IAAI,CAAC,IAAI,EAAE;QAE3D,MAAM,IAAI;YACR,UAAU,MAAM,QAAQ;YACxB,MAAM,MAAM,IAAI;YAChB,MAAM,MAAM,IAAI;YAChB,aAAa;QACf;QAEA,aAAa,OAAO,CAAC,iBAAiB,KAAK,SAAS,CAAC;QACrD,QAAQ;QACR,OAAO;IACT;IAEA,MAAM,SAAS;QACb,aAAa,UAAU,CAAC;QACxB,QAAQ;IACV;IAEA,sBAAsB;IACtB,MAAM,gBAAgB,CAAC;QACrB,IAAI,CAAC,MAAM,OAAO;QAClB,IAAI,CAAC,KAAK,WAAW,EAAE,OAAO;QAC9B,OAAO,KAAK,WAAW,CAAC,QAAQ,CAAC;IACnC;IAEA,oCAAoC;IACpC,MAAM,iBAAiB,CAAC;QACtB,IAAI,CAAC,MAAM,OAAO;QAElB,MAAM,WAAW,oIAAiB,CAAC,KAAK;QACxC,IAAI,CAAC,UAAU,OAAO,MAAM,YAAY;QAExC,OAAO,SAAS,IAAI,CAAC,CAAC,OAAS,KAAK,WAAW,CAAC,QAAQ,CAAC;IAC3D;IAEA,qBACE,qKAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,MAAM,UAAU,IAAM,IAAA,iHAAU,EAAC,cAiBxC,4BAA4B;CAC5B,+DAA+D;CAE/D,uCAAuC;CAEvC,+CAA+C;CAC/C,0DAA0D;CAC1D,uCAAuC;CACvC,2BAA2B;CAC3B,qDAAqD;CACrD,QAAQ;CAER,2BAA2B;CAC3B,gEAAgE;CAEhE,aAAa;CACb,sEAAsE;CACtE,mBAAmB;CACnB,8BAA8B;CAC9B,OAAO;CACP,IAAI;CAEJ,8BAA8B;CAC9B,oCAAoC;CACpC,IAAI;CAWJ,+DAA+D;CAE/D,uCAAuC;CAEvC,+CAA+C;CAC/C,uCAAuC;CACvC,2BAA2B;CAC3B,qDAAqD;CACrD,QAAQ;CAER,uCAAuC;CACvC,wCAAwC;CACxC,OAAO;CAEP,aAAa;CACb,sEAAsE;CACtE,mBAAmB;CACnB,8BAA8B;CAC9B,OAAO;CACP,IAAI;CAEJ,wDAAwD","debugId":null}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///E:/pharmacy-system-v2/frontend/pages/_app.js"],"sourcesContent":["import \"../styles/globals.css\";\r\nimport { AuthProvider } from \"../context/AuthContext\";\r\nimport { Toaster } from \"react-hot-toast\";\r\nimport Guard from \"../components/Guard\";\r\n\r\nexport default function MyApp({ Component, pageProps }) {\r\n  return (\r\n    <AuthProvider>\r\n      <Toaster position=\"top-center\" />\r\n      <Guard Component={Component} pageProps={pageProps} />\r\n    </AuthProvider>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// // pages/_app.js\r\n// import \"../styles/globals.css\";\r\n// import { Toaster } from \"react-hot-toast\";\r\n// import { AuthProvider } from \"../context/AuthContext\";\r\n// import { InventoryProvider } from \"../context/InventoryContext\";\r\n// import { ShiftProvider } from \"../context/ShiftContext\";\r\n\r\n// export default function MyApp({ Component, pageProps }) {\r\n//   return (\r\n//     <AuthProvider>\r\n//       <InventoryProvider>\r\n//         <ShiftProvider>\r\n//           <>\r\n//             <Toaster position=\"top-center\" />\r\n//             <Component {...pageProps} />\r\n//           </>\r\n//         </ShiftProvider>\r\n//       </InventoryProvider>\r\n//     </AuthProvider>\r\n//   );\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// // pages/_app.js\r\n// import \"../styles/globals.css\";\r\n// import { useRouter } from \"next/router\";\r\n// import AuthGuard from \"../components/AuthGuard\";\r\n// import { InventoryProvider } from \"../context/InventoryContext\";\r\n\r\n// export default function MyApp({ Component, pageProps }) {\r\n//   const router = useRouter();\r\n\r\n//   const publicRoutes = [\"/\"]; // صفحة تسجيل الدخول مثلاً\r\n//   const isPublic = publicRoutes.includes(router.pathname);\r\n\r\n//   if (isPublic) {\r\n//     return (\r\n//       <InventoryProvider>\r\n//         <Component {...pageProps} />\r\n//       </InventoryProvider>\r\n//     );\r\n//   }\r\n\r\n//   return (\r\n//     <InventoryProvider>\r\n//       <AuthGuard>\r\n//         <Component {...pageProps} />\r\n//       </AuthGuard>\r\n//     </InventoryProvider>\r\n//   );\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import '../styles/globals.css'\r\n// import { useRouter } from 'next/router'\r\n// import AuthGuard from '../components/AuthGuard'\r\n\r\n// export default function MyApp({ Component, pageProps }) {\r\n//   const router = useRouter()\r\n\r\n//   // المسارات العامة\r\n//   const publicRoutes = ['/']\r\n\r\n//   const isPublic = publicRoutes.includes(router.pathname)\r\n\r\n//   if (isPublic) {\r\n//     return <Component {...pageProps} />\r\n//   }\r\n\r\n//   return (\r\n//     <AuthGuard>\r\n//       <Component {...pageProps} />\r\n//     </AuthGuard>\r\n//   )\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n// // pages/_app.js\r\n// import '../styles/globals.css'\r\n// import { useRouter } from 'next/router'\r\n// import AuthGuard from '../components/AuthGuard'\r\n\r\n// export default function MyApp({ Component, pageProps }) {\r\n//   const router = useRouter()\r\n\r\n//   // المسارات المسموح الوصول لها بدون تسجيل دخول\r\n//   const publicRoutes = ['/']\r\n\r\n//   const isPublic = publicRoutes.includes(router.pathname)\r\n\r\n//   if (isPublic) {\r\n//     return <Component {...pageProps} />\r\n//   }\r\n\r\n//   return (\r\n//     <AuthGuard>\r\n//       <Component {...pageProps} />\r\n//     </AuthGuard>\r\n//   )\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// // pages/_app.js\r\n// import '../styles/globals.css'\r\n\r\n// import { Toaster } from 'react-hot-toast'\r\n\r\n// export default function MyApp({ Component, pageProps }) {\r\n//   return (\r\n//     <>\r\n//       {/* ✅ مكوّن التوستر العام */}\r\n//       <Toaster\r\n//         position=\"top-left\"\r\n//         toastOptions={{\r\n//           duration: 3000,\r\n//           style: { fontFamily: 'Tajawal, sans-serif', direction: 'rtl' },\r\n//           success: {\r\n//             iconTheme: {\r\n//               primary: '#10B981',\r\n//               secondary: 'white',\r\n//             },\r\n//           },\r\n//           error: {\r\n//             iconTheme: {\r\n//               primary: '#EF4444',\r\n//               secondary: 'white',\r\n//             },\r\n//           },\r\n//         }}\r\n//       />\r\n//       <Component {...pageProps} />\r\n//     </>\r\n//   )\r\n// }\r\n\r\n\r\n\r\n\r\n// // pages/_app.js\r\n// import '../styles/globals.css' // استيراد تنسيقات Tailwind\r\n// import { Tajawal } from 'next/font/google'\r\n\r\n// // تحميل الخط من Google\r\n// const tajawal = Tajawal({\r\n//   subsets: ['arabic'],\r\n//   weight: ['400', '500', '700']\r\n// })\r\n\r\n// export default function MyApp({ Component, pageProps }) {\r\n//   return (\r\n//     <div className={tajawal.className}>\r\n//       <Component {...pageProps} />\r\n//     </div>\r\n//   )\r\n// }\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;;;;;;;;;;;;AAGe,SAAS,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;IACpD,qBACE,qKAAC,+HAAY;;0BACX,qKAAC,qJAAO;gBAAC,UAAS;;;;;;0BAClB,qKAAC;gBAAM,WAAW;gBAAW,WAAW;;;;;;;;;;;;AAG9C,EAqBA,mBAAmB;CACnB,kCAAkC;CAClC,6CAA6C;CAC7C,yDAAyD;CACzD,mEAAmE;CACnE,2DAA2D;CAE3D,4DAA4D;CAC5D,aAAa;CACb,qBAAqB;CACrB,4BAA4B;CAC5B,0BAA0B;CAC1B,eAAe;CACf,gDAAgD;CAChD,2CAA2C;CAC3C,gBAAgB;CAChB,2BAA2B;CAC3B,6BAA6B;CAC7B,sBAAsB;CACtB,OAAO;CACP,IAAI;CAgBJ,mBAAmB;CACnB,kCAAkC;CAClC,2CAA2C;CAC3C,mDAAmD;CACnD,mEAAmE;CAEnE,4DAA4D;CAC5D,gCAAgC;CAEhC,2DAA2D;CAC3D,6DAA6D;CAE7D,oBAAoB;CACpB,eAAe;CACf,4BAA4B;CAC5B,uCAAuC;CACvC,6BAA6B;CAC7B,SAAS;CACT,MAAM;CAEN,aAAa;CACb,0BAA0B;CAC1B,oBAAoB;CACpB,uCAAuC;CACvC,qBAAqB;CACrB,2BAA2B;CAC3B,OAAO;CACP,IAAI;CAoBJ,iCAAiC;CACjC,0CAA0C;CAC1C,kDAAkD;CAElD,4DAA4D;CAC5D,+BAA+B;CAE/B,uBAAuB;CACvB,+BAA+B;CAE/B,4DAA4D;CAE5D,oBAAoB;CACpB,0CAA0C;CAC1C,MAAM;CAEN,aAAa;CACb,kBAAkB;CAClB,qCAAqC;CACrC,mBAAmB;CACnB,MAAM;CACN,IAAI;CAMJ,mBAAmB;CACnB,iCAAiC;CACjC,0CAA0C;CAC1C,kDAAkD;CAElD,4DAA4D;CAC5D,+BAA+B;CAE/B,mDAAmD;CACnD,+BAA+B;CAE/B,4DAA4D;CAE5D,oBAAoB;CACpB,0CAA0C;CAC1C,MAAM;CAEN,aAAa;CACb,kBAAkB;CAClB,qCAAqC;CACrC,mBAAmB;CACnB,MAAM;CACN,IAAI;CAWJ,mBAAmB;CACnB,iCAAiC;CAEjC,4CAA4C;CAE5C,4DAA4D;CAC5D,aAAa;CACb,SAAS;CACT,sCAAsC;CACtC,iBAAiB;CACjB,8BAA8B;CAC9B,0BAA0B;CAC1B,4BAA4B;CAC5B,4EAA4E;CAC5E,uBAAuB;CACvB,2BAA2B;CAC3B,oCAAoC;CACpC,oCAAoC;CACpC,iBAAiB;CACjB,eAAe;CACf,qBAAqB;CACrB,2BAA2B;CAC3B,oCAAoC;CACpC,oCAAoC;CACpC,iBAAiB;CACjB,eAAe;CACf,aAAa;CACb,WAAW;CACX,qCAAqC;CACrC,UAAU;CACV,MAAM;CACN,IAAI;CAKJ,mBAAmB;CACnB,6DAA6D;CAC7D,6CAA6C;CAE7C,0BAA0B;CAC1B,4BAA4B;CAC5B,yBAAyB;CACzB,kCAAkC;CAClC,KAAK;CAEL,4DAA4D;CAC5D,aAAa;CACb,0CAA0C;CAC1C,qCAAqC;CACrC,aAAa;CACb,MAAM;CACN,IAAI","debugId":null}}]
}